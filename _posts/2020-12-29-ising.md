---
title: "Classical Ising model with MCMC"
toc: true
toc_sticky: true
date: 2020-12-29 18:07:00
categories: 
  - Physics
tags: 
  - thermodynamics & statistical physics
  - computational physics
  - Ising model
use_math: true
---

## Classical Ising model
Classical Ising model is briefly explained in <https://aadeliee22.github.io/physics/tsp-presentation/#classical-ising-model>.
This model is the simplest model of a magnet. Here, I will invest some special thermal properties of this model, with second-order phase transition and critical point.

## Background
Some thermodynamic and statistical backgrounds, as well as Monte Carlo methods.

First, by determining [Helmholtz free energy](https://en.wikipedia.org/wiki/Helmholtz_free_energy) of system $\mathcal{F} = -kT\ln Z$, we know that
$$
S = -\left(\frac{\partial \mathcal{F}}{\partial T}\right)_{V, N}, P = -\left(\frac{\partial \mathcal{F}}{\partial V}\right)_{T, N}, 
\mu = -\left(\frac{\partial \mathcal{F}}{\partial N}\right)_{T, V}
$$
Moreover, using these, we now obtain other quantities that may use as order parameters.
$$
U = -\frac{1}{Z}\frac{\partial Z}{\partial\beta} = -\frac{\partial}{\partial\beta}\ln Z = -T^2 \frac{\partial (\mathcal{F}/T)}{\partial T} = \langle E \rangle
\\ \begin{aligned} C &= T \frac{\partial S}{\partial T} = -\beta \frac{\partial S}{\partial \beta}= \frac{\partial U}{\partial T} 
= k\beta^2 \frac{\partial^2}{\partial \beta^2}\ln Z 
\\&=k\beta^2\left(\frac{1}{Z}\frac{\partial^2}{\partial\beta^2}Z - \left[ \frac{1}{Z}\frac{\partial}{\partial \beta}Z\right]^2\right) 
=k\beta^2(\langle E^2\rangle - \langle E\rangle^2) \end{aligned}
\\M = \frac{\partial \mathcal{F}}{\partial B} = \left\langle \sum_i s_i \right\rangle, \;\; \chi = \frac{\partial\langle M\rangle}{\partial B} 
= \beta (\langle M^2\rangle - \langle M \rangle ^2)
$$
where $U$ is internal energy, $C$ is specific heat capacity, and $M$ is magnetization, $\chi$ is magnetic susceptibility. 
Therefore, by knowing partition function, we could drive almost all quantities that we need.

### Some solution of classical Ising model
Mean field approximation of $d$-dimensional lattice is explained in <https://aadeliee22.github.io/physics/tsp-presentation/#mean-field-theory-for-d-dimensional-lattice>. 
Here, I will show exact solution for 1D lattice.

Consider 1-dimensional Ising model of periodic boundary that has $N$ sites. Given Hamiltonian, the partition function is
$$
\begin{aligned}
Z =& \sum_{\{\vec{s}\}}\exp(\beta J (s_1s_2 + \cdots + s_N s_1)+ \beta B(s_1+\cdots+s_N))
\\=& \sum_{\{\vec{s}\}}\exp(\beta J (s_1s_2 + \cdots + s_N s_1)+ \frac{1}{2}\beta B((s_1+s_2)+\cdots+(s_N+s_1))
\\=& \sum_{\{\vec{s}\}}\underbrace{\exp(\beta Js_1s_2+\frac{1}{2}\beta B(s_1+s_2))}_{\langle s_1|T|s_2\rangle}\cdots\underbrace{\exp(\beta Js_Ns_1+\frac{1}{2}\beta B(s_N+s_1))}_{\langle s_N|T|s_1\rangle}
\\=& \sum_{s_1}\cdots\sum_{s_N}\langle s_1|T|s_2\rangle\cdots\langle s_N|T|s_1\rangle = \sum_{s_1}\langle s_1|T|s_1\rangle = \text{Tr}(T^N) = \sum\lambda_i^N
\end{aligned}
$$

The $T$ part acts like a matrix, as each spin is either $1$ or $-1$. 
$$
T = \begin{array}{c|cc}s_i, s_{i+1}&+1 & -1 \\\hline
+1 & e^{\beta(J+B)} & e^{-\beta J}
\\-1 & e^{-\beta J} & e^{\beta(J-B)}
\end{array}
$$
This matrix has eigenvalue of 
$$
\lambda = e^{\beta J}\cosh \beta B\,\pm\sqrt{e^{2\beta J}\cosh^2\beta B-2\sinh2\beta J} 
$$
For $B=0$, $\lambda = e^{\beta J}\pm e^{-\beta J}$. Using this, we can calculate free energy and internal energy each.
$$
\mathcal{F} = -kT\ln Z = -\beta N\ln 2\cosh\beta J
\\ U = -\frac{\partial}{\partial \beta}\ln Z = -JN\tanh\beta J
$$
